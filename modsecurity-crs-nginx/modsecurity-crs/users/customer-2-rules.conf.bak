# ModSecurity Custom Rules for User 2
# Generated: 2025-09-15T09:02:18.292Z

# Keep engine ON (the base CRS is loaded by the image's default config)
SecRuleEngine On

# Inject tenant id into TX collection for audit/logging
SecAction "id:1200004,phase:1,pass,nolog,setvar:tx.user_id=2"

# Emit tenant id at transaction end into the audit log (phase 5)
SecAction "id:1200005,phase:5,pass,log,auditlog,msg:'tenant=%{tx.user_id}'"

# Place your custom rules below. Examples:
#
# Block specific IP
# SecRule REMOTE_ADDR "@ipMatch 123.123.123.123" #   "id:900201,phase:1,deny,status:403,msg:'Blocked specific IP address'"
#
# Block a User-Agent
# SecRule REQUEST_HEADERS:User-Agent "@contains badbot" #   "id:900202,phase:1,deny,status:403,msg:'Blocked bad bot'"
# BEGIN CUSTOM RULES - DO NOT EDIT BELOW
SecRule REQUEST_HEADERS:User-Agent "@contains BadBot" "phase:1,deny,status:403,msg:'차단된 User-Agent',id:1202000"
# END CUSTOM RULES - DO NOT EDIT ABOVE
