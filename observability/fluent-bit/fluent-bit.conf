[SERVICE]
    Flush        1
    Daemon       Off
    Log_Level    info
    Parsers_File /fluent-bit/etc/parsers_multiline.conf
    Parsers_File /fluent-bit/etc/parsers.conf

# ModSecurity audit JSON (multi-line JSON per transaction)
[INPUT]
    Name              tail
    Path              /tmp/modsec_audit.json
    Parser            modsec_json
    Tag               modsecurity.audit
    Refresh_Interval  5

[FILTER]
    Name    modify
    Match   modsecurity.audit
    Add     source waf

# Ship to backend via HTTP
[OUTPUT]
    Name               http
    Match              *
    Host               backend-server
    Port               3001
    URI                /ingest/logs
    Format             json
    Json_date_key      timestamp
    Json_date_format   iso8601

# Debug output
[OUTPUT]
    Name               stdout
    Match              *

