# JSON parser for single-line Nginx access records
[PARSER]
    Name        json
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S%z

# Docker JSON log parser (for reference if needed)
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

# Multiline start detector for ModSecurity audit JSON
[PARSER]
    Name        modsec_json_start
    Format      regex
    Regex       ^\{"transaction":.*

# JSON parser for full ModSecurity audit JSON
[PARSER]
    Name        modsec_json
    Format      json
    Time_Key    transaction.time_stamp
    Time_Format %Y/%m/%d %H:%M:%S
